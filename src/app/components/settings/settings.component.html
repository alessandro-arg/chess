<div *ngIf="!inChild" class="min-h-screen bg-steel-bg">
  <div
    class="fixed top-10 right-10 w-32 h-32 bg-steel-primary/5 rounded-full blur-3xl pointer-events-none"
  ></div>
  <div
    class="fixed bottom-20 left-15 w-24 h-24 bg-steel-accent/5 rounded-full blur-2xl pointer-events-none"
  ></div>

  <!-- Full screen container -->
  <div class="w-full min-w-[320px] mx-auto">
    <!-- Header with title and back button -->
    <div
      class="sticky top-0 z-10 bg-steel-secondary/90 backdrop-blur-lg border-b border-steel-primary/20"
    >
      <div
        class="max-w-2xl mx-auto px-4 py-6 flex items-center justify-between"
      >
        <div class="flex items-center gap-3">
          <button
            (click)="goBackToDashboard()"
            class="p-2 rounded-lg hover:bg-steel-bg/30 focus:outline-none focus:ring-2 focus:ring-steel-accent transition-colors"
            aria-label="Back to dashboard"
          >
            <svg
              class="w-5 h-5 text-steel-accent"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 19l-7-7 7-7"
              />
            </svg>
          </button>
          <h1 class="text-xl font-semibold text-white">{{ getViewTitle() }}</h1>
        </div>
      </div>
    </div>

    <!-- Back button for sub-views -->
    <div *ngIf="currentView !== 'main'" class="max-w-2xl mx-auto px-4 pt-4">
      <button
        (click)="onBack()"
        class="flex items-center gap-2 text-steel-accent hover:text-steel-primary focus:outline-none focus:ring-2 focus:ring-steel-accent rounded-lg p-2 transition-colors"
        aria-label="Back to main settings"
      >
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"
          />
        </svg>
        <span class="text-sm font-medium">Back</span>
      </button>
    </div>

    <!-- Main content container -->
    <div
      class="max-w-2xl mx-auto px-4 py-6 space-y-6"
      *ngIf="userProfile$ | async as profile"
    >
      <!-- Main Settings View -->
      <div *ngIf="currentView === 'main'" class="space-y-6">
        <!-- User Header Block -->
        <div
          class="bg-steel-secondary/70 backdrop-blur-xl rounded-2xl border border-steel-primary/20 shadow-2xl p-6"
        >
          <div class="flex items-center gap-4">
            <!-- Avatar -->
            <div class="flex-shrink-0">
              <img
                *ngIf="getAvatarUrl(profile); else defaultAvatar"
                [src]="getAvatarUrl(profile)!"
                [alt]="getDisplayName(profile) + ' avatar'"
                class="w-20 h-20 sm:w-24 sm:h-24 rounded-xl object-cover bg-steel-bg/40 border border-steel-primary/10"
              />
              <ng-template #defaultAvatar>
                <div
                  class="w-20 h-20 sm:w-24 sm:h-24 rounded-xl bg-steel-bg/40 border border-steel-primary/20 flex items-center justify-center"
                >
                  <svg
                    class="w-10 h-10 text-steel-accent"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                    />
                  </svg>
                </div>
              </ng-template>
            </div>

            <!-- User Info -->
            <div class="flex-1 min-w-0">
              <h2 class="text-white font-bold text-xl sm:text-2xl truncate">
                {{ getDisplayName(profile) }}
              </h2>
              <p class="text-gray-300 text-sm mt-1" *ngIf="profile.email">
                {{ profile.email }}
              </p>
              <p class="text-gray-400 text-sm mt-1" *ngIf="profile.createdAt">
                Member since {{ profile.createdAt | date : "d MMMM y" }}
              </p>
            </div>
          </div>
        </div>

        <!-- Navigation List -->
        <div
          class="bg-steel-secondary/50 backdrop-blur-xl rounded-2xl border border-steel-primary/20 shadow-2xl overflow-hidden"
        >
          <ul role="menu" class="divide-y divide-steel-primary/10">
            <!-- Profile Settings -->
            <li role="menuitem">
              <button
                (click)="openProfileSettings()"
                class="w-full flex items-center justify-between gap-4 p-4 sm:p-6 transition-colors hover:bg-steel-bg/20 focus:outline-none focus:ring-2 focus:ring-steel-accent focus:ring-inset"
                aria-label="Profile Settings"
              >
                <div class="flex items-center gap-4">
                  <div class="p-2 bg-steel-bg/30 rounded-lg">
                    <svg
                      class="w-6 h-6 text-steel-accent"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                      />
                    </svg>
                  </div>
                  <span class="text-white font-medium text-lg"
                    >Profile Settings</span
                  >
                </div>
                <svg
                  class="w-5 h-5 text-gray-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 5l7 7-7 7"
                  />
                </svg>
              </button>
            </li>

            <!-- Privacy Policy -->
            <li role="menuitem">
              <button
                (click)="navigateToView('privacy')"
                class="w-full flex items-center justify-between gap-4 p-4 sm:p-6 transition-colors hover:bg-steel-bg/20 focus:outline-none focus:ring-2 focus:ring-steel-accent focus:ring-inset"
                aria-label="Privacy Policy"
              >
                <div class="flex items-center gap-4">
                  <div class="p-2 bg-steel-bg/30 rounded-lg">
                    <svg
                      class="w-6 h-6 text-steel-accent"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
                      />
                    </svg>
                  </div>
                  <span class="text-white font-medium text-lg"
                    >Privacy Policy</span
                  >
                </div>
                <svg
                  class="w-5 h-5 text-gray-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 5l7 7-7 7"
                  />
                </svg>
              </button>
            </li>

            <!-- Impressum -->
            <li role="menuitem">
              <button
                (click)="navigateToView('impressum')"
                class="w-full flex items-center justify-between gap-4 p-4 sm:p-6 transition-colors hover:bg-steel-bg/20 focus:outline-none focus:ring-2 focus:ring-steel-accent focus:ring-inset"
                aria-label="Impressum"
              >
                <div class="flex items-center gap-4">
                  <div class="p-2 bg-steel-bg/30 rounded-lg">
                    <svg
                      class="w-6 h-6 text-steel-accent"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                      />
                    </svg>
                  </div>
                  <span class="text-white font-medium text-lg">Impressum</span>
                </div>
                <svg
                  class="w-5 h-5 text-gray-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 5l7 7-7 7"
                  />
                </svg>
              </button>
            </li>

            <!-- Support -->
            <li role="menuitem">
              <button
                (click)="openSupport()"
                class="w-full flex items-center justify-between gap-4 p-4 sm:p-6 transition-colors hover:bg-steel-bg/20 focus:outline-none focus:ring-2 focus:ring-steel-accent focus:ring-inset"
                aria-label="Support"
              >
                <div class="flex items-center gap-4">
                  <div class="p-2 bg-steel-bg/30 rounded-lg">
                    <svg
                      class="w-6 h-6 text-steel-accent"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192L5.636 18.364M12 2.944l5.657 5.657a8 8 0 010 11.314L12 25.258l-5.657-5.343a8 8 0 010-11.314L12 2.944z"
                      />
                    </svg>
                  </div>
                  <span class="text-white font-medium text-lg">Support</span>
                </div>
                <svg
                  class="w-5 h-5 text-gray-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 5l7 7-7 7"
                  />
                </svg>
              </button>
            </li>

            <!-- Logout -->
            <li role="menuitem">
              <button
                (click)="onLogout()"
                class="w-full flex items-center justify-between gap-4 p-4 sm:p-6 transition-colors hover:bg-red-900/20 focus:outline-none focus:ring-2 focus:ring-steel-accent focus:ring-inset logout-button"
                aria-label="Logout"
              >
                <div class="flex items-center gap-4">
                  <div class="p-2 bg-red-900/30 rounded-lg">
                    <svg
                      class="w-6 h-6 text-red-400"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                      />
                    </svg>
                  </div>
                  <span class="text-red-300 font-medium text-lg">Logout</span>
                </div>
                <svg
                  class="w-5 h-5 text-red-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 5l7 7-7 7"
                  />
                </svg>
              </button>
            </li>
          </ul>
        </div>
      </div>

      <!-- Privacy Policy View -->
      <div
        *ngIf="currentView === 'privacy'"
        class="bg-steel-secondary/50 backdrop-blur-xl rounded-2xl border border-steel-primary/20 shadow-2xl p-6"
      >
        <div class="prose prose-invert max-w-none">
          <h3 class="text-2xl font-bold text-white mb-6">Privacy Policy</h3>
          <div class="text-gray-300 space-y-4 leading-relaxed">
            <p>
              This privacy policy describes how we collect, use, and protect
              your personal information when you use our service.
            </p>
            <h4 class="font-semibold text-white text-lg mt-6 mb-3">
              Information We Collect
            </h4>
            <p>
              We collect information you provide directly to us, such as when
              you create an account, update your profile, or contact us for
              support.
            </p>
            <h4 class="font-semibold text-white text-lg mt-6 mb-3">
              How We Use Your Information
            </h4>
            <p>
              We use your information to provide, maintain, and improve our
              services, communicate with you, and ensure the security of our
              platform.
            </p>
            <h4 class="font-semibold text-white text-lg mt-6 mb-3">
              Data Protection
            </h4>
            <p>
              We implement appropriate security measures to protect your
              personal information against unauthorized access, alteration,
              disclosure, or destruction.
            </p>
          </div>
        </div>
      </div>

      <!-- Impressum View -->
      <div
        *ngIf="currentView === 'impressum'"
        class="bg-steel-secondary/50 backdrop-blur-xl rounded-2xl border border-steel-primary/20 shadow-2xl p-6"
      >
        <div class="prose prose-invert max-w-none">
          <h3 class="text-2xl font-bold text-white mb-6">Impressum</h3>
          <div class="text-gray-300 space-y-4 leading-relaxed">
            <div>
              <h4 class="font-semibold text-white text-lg mb-3">
                Company Information
              </h4>
              <p>
                Your Company Name<br />
                Your Address Line 1<br />
                Your Address Line 2<br />
                Your City, State ZIP
              </p>
            </div>
            <div>
              <h4 class="font-semibold text-white text-lg mb-3">Contact</h4>
              <p>
                Email: infoETyourcompany.com<br />
                Phone: +1 (555) 123-4567
              </p>
            </div>
            <div>
              <h4 class="font-semibold text-white text-lg mb-3">Legal</h4>
              <p>
                Responsible for content according to § 55 Abs. 2 RStV:<br />
                Your Name<br />
                Your Address
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<router-outlet></router-outlet>
